<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Jurjan Brust - Migrating large corporate SharePoint intranets</title>
<meta name="description" content="Development">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">
<link rel="stylesheet" href="https://jurjan.info/css/bootstrap.min.css">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:400,300,700,400italic">
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:100">
<link rel="stylesheet" href="https://jurjan.info/css/font-awesome.min.css">
<link rel="stylesheet" href="https://jurjan.info/css/owl.carousel.css">
<link rel="stylesheet" href="https://jurjan.info/css/owl.theme.css">


  <link href="https://jurjan.info/css/style.blue.css" rel="stylesheet" id="theme-stylesheet">

 

  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  


<link href="https://jurjan.info/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="https://jurjan.info/img/favicon.png">



</head>
<body>
  <div id="all">
      <div class="container-fluid">
          <div class="row row-offcanvas row-offcanvas-left">
              <div id="sidebar" class="col-xs-6 col-sm-4 col-md-3 sidebar-offcanvas">
  <div class="sidebar-content">
    <a href="/"> <img src="/img/jurjan.png" class="avatar" /> </a>
    <h1 class="sidebar-heading"><a href="https://jurjan.info/">Jurjan Brust</a></h1>
    
      <p class="sidebar-p">SharePoint | O365 | Azure | IoT</p>
    
    <ul class="sidebar-menu">
      
        <li><a href="https://jurjan.info/posts/">HOME</a></li>
      
        <li><a href="https://jurjan.info/categories/azure">AZURE</a></li>
      
        <li><a href="https://jurjan.info/categories/sharepoint">SHAREPOINT / O365</a></li>
      
        <li><a href="https://jurjan.info/about/">ABOUT</a></li>
      
        <li><a href="https://jurjan.info/contact/">CONTACT</a></li>
      
    </ul>
    <p class="social">
  
  <a href="/index.xml" data-animate-hover="pulse" class="email">
    <i class="fa fa-rss"></i>
  </a>
  
  
  <a href="https://www.linkedin.com/in/jurjanbrust/" data-animate-hover="pulse" class="external">
    <i class="fa fa-linkedin"></i>
  </a>
  
  
  
  
  <a href="https://twitter.com/jurjanbrust" data-animate-hover="pulse" class="external twitter">
    <i class="fa fa-twitter"></i>
  </a>
  
  
  
  
  <a href="https://github.com/jurjanbrust" data-animate-hover="pulse" class="external">
    <i class="fa fa-github"></i>
  </a>
  
  
  
  
  <a href="mailto:mail@jurjan.info" data-animate-hover="pulse" class="email">
    <i class="fa fa-envelope"></i>
  </a>
  
</p>


    <div class="copyright">
      <p class="credit">
        
          &copy;2019 Jurjan Brust
        
        
      </p>
    </div>
  </div>
</div>

              
<div class="col-xs-12 col-sm-8 col-md-9 content-column white-background">
  <div class="small-navbar visible-xs">
  <button type="button" data-toggle="offcanvas" class="btn btn-ghost pull-left"> <i class="fa fa-align-left"> </i>Menu</button>
  <h1 class="small-navbar-heading"><a href="https://jurjan.info/">Jurjan Brust</a></h1>
</div>

  <div class="row">
    <div class="col-lg-8">
      <div class="content-column-content">
         <h1>Migrating large corporate SharePoint intranets</h1>
         <ul>
<li><input checked="" disabled="" type="checkbox"><a href="/posts/sharepoint/migration/i.approach/">Approach</a> (part I of IV)</li>
<li><input checked="" disabled="" type="checkbox"><a href="/posts/sharepoint/migration/ii.analysis">Analysis</a> (part II of IV)</li>
<li><input disabled="" type="checkbox"><a href="/posts/sharepoint/migration/iii.migrate">Migration</a> (part III of IV)</li>
<li><input disabled="" type="checkbox"><a href="/posts/sharepoint/migration/iv.verification">Verification</a> (part IV of IV)</li>
</ul>
<h2 id="analysis">Analysis</h2>
<p>Your most valuable resource for information about the to-be-migrated environment will be the users itself. Getting to know who is working on the SharePoint site and how they are using it is vital for your analysis. Also use the opportunity to give insights about your migration strategy.
Your second most valuable tool will be to use scripting in order to analyse the environment. I included the complete source-code of the scripts that I am using in this post.</p>
<h3 id="when-customizations-become-an-application">When customizations become an application</h3>
<p>Co-workers in the organization start to use SharePoint as a tool to facilitate daily work. Some used only by a few people and others used by a large group of people as a daily driver. These co-workers who created these customisation often are called &lsquo;power users&rsquo; or &lsquo;citizen developers&rsquo;. Power users are focussed on solving business problems and less on topics such as performance, scalability, security, efficiency and product lifecycle.</p>
<p>What started as a small simple customization can eventually become a full blown business critical application with data exchanges to other line-of-business systems.
These SharePoint applications will become harder to maintain over time and SharePoint boundaries will become impossible to solve without a complete redesign.
Changes that are being applied lead to unavailability of the application. Often due to simple user errors or otherwise because the changes require hours to implement manually.</p>
<p>When you find such an application it is important to ask yourself the following questions.</p>
<ul>
<li><input disabled="" type="checkbox">Is SharePoint still the right platform for this to run?</li>
<li><input disabled="" type="checkbox">Is the application still manageable?</li>
<li><input disabled="" type="checkbox">Are web parts / tooling / other parts still supported in the Microsoft roadmap?</li>
</ul>
<p>If the answer of one of these questions is no you should consider to rebuild instead of migrate.</p>
<h3 id="finding-customizations">Finding customizations</h3>
<p>Once you talked to the end-users and / or business owner of the SharePoint site(s) and explained the migration strategy it is time to use tooling in order to analyse the farm.
A list of items to look for is:</p>
<ol>
<li>InfoPath forms: this is a big indication of customization.</li>
<li>JavaScript files: this is yet another big indication of customization.</li>
<li>SharePoint Workflows: workflows are an indication for business processes.</li>
<li>List information. List information gives insight into:
<ol>
<li>item count.</li>
<li>list base types such as KPI (key performance indicator). KPI is an excellent example of a problem when migrating to SharePoint online. This because SharePoint 2010 / 2013 KPI's are deprecated. A redesign will be unavoidable.</li>
</ol>
</li>
<li>Large files: find files larger than destination limit : 250 is default for on premises.</li>
<li>File versions: document versions can take up a lot of space, especially for non-office documents. track down these files and limit the number of versions if possible.</li>
</ol>
<p>Other filetypes to look for are: CSS, XML, DOCM, ACCESS, HTML, XSL/T.
Know which site-templates have been used and how permissions have been set and finally the content types used.</p>
<h4 id="folder-structure">Folder structure</h4>
<p>In the folder structure you will see all the files needed in order to do an analysis of the content in the SharePoint environment. All files displayed below will be explained in descending order.</p>
<p>![](/img/II.Analysis/II.Analysis_2019-10-22-15-12-58.png# shadow)</p>
<h4 id="allfilesinonecmd">allfilesinone.cmd</h4>
<p>The <strong>analyseSharePoint.ps1</strong> script described below will generate a separate .csv file for every line in sites.csv. This .cmd will combine all these separate files into one combined.csv and only keep one column-header line. This allows the combines.csv to be opened in Excel. Excel is a great way to create PowerPivot tables and do all kinds of calculations on the data.</p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted -->open raw file<!-- raw HTML omitted --></p>
<h4 id="analysesharepointstartps1">analyseSharePoint_Start.ps1</h4>
<p>This script is the script that is to be executed. It reads an comma separated file called &lsquo;sites.csv&rsquo; that is containing all the URLs to analyse. Note that it is possible to analyse all the subsites by using only one URL (recursion).</p>
<p><code>Note: in order to allow the PowerShell to execute on your local machine you might need to change the execution policy (Set-ExecutionPolicy)</code></p>
<!-- raw HTML omitted -->
<p><!-- raw HTML omitted -->open raw file<!-- raw HTML omitted --></p>
<h4 id="analysesharepointps1">analyseSharePoint.ps1</h4>
<p>The main script that contains all the functions needed in order to analyse. I know that it is big, but it is also well structured and easy to extend.
It is using SharePoint CSOM to connect and query the SharePoint farm.
Change the following variable to change the type of analysis:</p>
<pre><code>$function = [Options]::lists 
</code></pre><!-- raw HTML omitted -->
<p><!-- raw HTML omitted -->open raw file<!-- raw HTML omitted --></p>
<h4 id="microsoftsharepointclient">Microsoft.SharePoint.Client</h4>
<p>The client DLLs included in this package are SharePoint 2010 assemblies. These can be replaced by the assemblies of other SharePoint versions.</p>
<h4 id="see-it-in-action">See it in action</h4>
<p>Download the complete solution <a href="/files/sharepoint/analyse_sources/analyse_sources.zip">here</a></p>
<p>Just to give you an idea of the solution here are some screenshots:</p>
<p>![](/img/II.Analysis/II.Analysis_2019-10-23-07-59-40.png# shadow)</p>
<p>Screenshot of a document library that contains some InfoPath files.</p>
<p>![](/img/II.Analysis/II.Analysis_2019-10-23-08-00-07.png# shadow)</p>
<p>Screenshot of the script-output.</p>
<p>![](/img/II.Analysis/II.Analysis_2019-10-23-08-00-25.png# shadow)</p>
<p>Screenshot of the generated .csv output</p>
<h6 id="continue-reading-this-series-herepostssharepointmigrationiiimigrate">Continue reading this series <a href="/posts/sharepoint/migration/iii.migrate/">here</a></h6>
         
      </div>
    </div>
  </div>
</div>

          </div>
      </div>
  </div>
  <script src="https://jurjan.info/js/jquery.min.js"></script>
<script src="https://jurjan.info/js/bootstrap.min.js"></script>
<script src="https://jurjan.info/js/jquery.cookie.js"> </script>
<script src="https://jurjan.info/js/ekko-lightbox.js"></script>
<script src="https://jurjan.info/js/jquery.scrollTo.min.js"></script>
<script src="https://jurjan.info/js/masonry.pkgd.min.js"></script>
<script src="https://jurjan.info/js/imagesloaded.pkgd.min.js"></script>
<script src="https://jurjan.info/js/owl.carousel.min.js"></script>
<script src="https://jurjan.info/js/front.js"></script>



</body>
</html>
